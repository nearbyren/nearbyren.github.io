<!DOCTYPE html>
<html lang="zh">
<head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    
    <title>nearby.ren</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="nearby, 移动开发, 用户体验, 设计, Java, JavaWeb, Go">
<meta property="og:type" content="website">
<meta property="og:title" content="nearby.ren">
<meta property="og:url" content="http://b.nearby.ren/index.html">
<meta property="og:site_name" content="nearby.ren">
<meta property="og:description" content="nearby, 移动开发, 用户体验, 设计, Java, JavaWeb, Go">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="nearby.ren">
<meta name="twitter:description" content="nearby, 移动开发, 用户体验, 设计, Java, JavaWeb, Go">
    

    
        <link rel="alternate" href="/atom.xml" title="nearby.ren" type="application/atom+xml">
    

    
        <link rel="icon" href="/css/images/super.png# path to favicon">
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/open-sans/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.1.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
    
    


</head>
</html>
<body>
    <div id="container">
        <header id="header">
    <div id="header-main" class="header-inner">
        <div class="outer">
            <a href="/" id="logo">
                <i class="logo"></i>
                <span class="site-title">nearby.ren</span>
            </a>
            <nav id="main-nav">
                
                    <a class="main-nav-link" href="/">首页</a>
                
                    <a class="main-nav-link" href="/archives">目录</a>
                
                    <a class="main-nav-link" href="/categories">分类</a>
                
                    <a class="main-nav-link" href="/tags">Tags</a>
                
                    <a class="main-nav-link" href="/about">关于</a>
                
            </nav>
            
                
                <nav id="sub-nav">
                    <div class="profile" id="profile-nav">
                        <a id="profile-anchor" href="javascript:;">
                            <img class="avatar" src="/css/images/avatar.png">
                            <i class="fa fa-caret-down"></i>
                        </a>
                    </div>
                </nav>
            
            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索">
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="想要查找什么...">
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '文章',
            PAGES: '页面',
            CATEGORIES: '分类',
            TAGS: '标签',
            UNTITLED: '(未命名)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
        </div>
    </div>
    <div id="main-nav-mobile" class="header-sub header-inner">
        <table class="menu outer">
            <tr>
                
                    <td><a class="main-nav-link" href="/">首页</a></td>
                
                    <td><a class="main-nav-link" href="/archives">目录</a></td>
                
                    <td><a class="main-nav-link" href="/categories">分类</a></td>
                
                    <td><a class="main-nav-link" href="/tags">Tags</a></td>
                
                    <td><a class="main-nav-link" href="/about">关于</a></td>
                
                <td>
                    
    <div class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="搜索">
    </div>

                </td>
            </tr>
        </table>
    </div>
</header>

        <div class="outer">
            
                

<aside id="profile">
    <div class="inner profile-inner">
        <div class="base-info profile-block">
            <img id="avatar" src="/css/images/avatar.png">
            <h2 id="name">lr</h2>
            <h3 id="title">Android server web Go</h3>
            <span id="location"><i class="fa fa-map-marker"></i>china, Hainan</span>
            <a id="follow" target="_blank" href="https://github.com/nearbyren">关注我</a>
        </div>
        <div class="article-info profile-block">
            <div class="article-info-block">
                93
                <span>文章</span>
            </div>
            <div class="article-info-block">
                41
                <span>标签</span>
            </div>
        </div>
        
        <div class="profile-block social-links">
            <table>
                <tr>
                    
                    
                    <td>
                        <a href="https://gitee.com/mccapp" target="_blank" title="github">
                            <i class="fa fa-github"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://twitter.com/" target="_blank" title="twitter">
                            <i class="fa fa-twitter"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://www.facebook.com/" target="_blank" title="facebook">
                            <i class="fa fa-facebook"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="https://dribbble.com/" target="_blank" title="dribbble">
                            <i class="fa fa-dribbble"></i>
                        </a>
                    </td>
                    
                    <td>
                        <a href="/atom.xml" target="_blank" title="rss">
                            <i class="fa fa-rss"></i>
                        </a>
                    </td>
                    
                </tr>
            </table>
        </div>
        
    </div>
</aside>

            
            <section id="main">
    <article id="post-mac flutter 支持多个版本配置" class="article article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2021/05/31/mac flutter 支持多个版本配置/">mac flutter 支持多个版本配置</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2021/05/31/mac flutter 支持多个版本配置/">
            <time datetime="2021-05-31T01:47:42.000Z" itemprop="datePublished">2021-05-31</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/android/">android</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>, <a class="tag-link" href="/tags/flutter/">flutter</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <p>首先从官方下载需要的版本<br><a href="https://flutter.dev/docs/development/tools/sdk/releases?tab=macos#macos" target="_blank" rel="noopener">https://flutter.dev/docs/development/tools/sdk/releases?tab=macos#macos</a><br>1.将下载的放在自己存放的目录 例如我的如下<br><img src="/2021/05/31/mac flutter 支持多个版本配置/../../../../images/iShot2021-09-2512.10.30.png" alt="Alt text"></p>
<p>2.配置Flutter环境变量<br> 终端打开 执行 open ~/.bash_profile  打开bash_profile文件</p>
<p> 将文件中的：export PATH=/xx/xx/flutter/bin:$PATH   [xx代表你的文件目录]</p>
<p> 改成需要配置的flutter版本地址：export PATH=/xx/xx/flutter1.20.0/bin:$PATH</p>
<p> 然后执行：source ~/.bash_profile</p>
<p>最后检测flutter是否设置成功：flutter doctor</p>
<p>此处红框位置Flutter (Channel stable, 1.20.0, on macOS 11.4 20F71, locale zh-Hans-CN）<br>此处是bash_profile配置好的版本的话代表版本安装成功。</p>
<p><img src="/2021/05/31/mac flutter 支持多个版本配置/../../../../images/iShot2021-09-2512.21.46.png" alt="Alt text"></p>
<p>3.打开 Android studio 配置flutter版本和dart版本</p>
<p><img src="/2021/05/31/mac flutter 支持多个版本配置/../../../../images/iShot2021-09-2512.25.42.png" alt="Alt text"><br><img src="/2021/05/31/mac flutter 支持多个版本配置/../../../../images/iShot2021-09-2512.25.18.png" alt="Alt text"></p>
<p>4.执行pubspec.yaml 的package get 更新一下库，若不报错，即更新完成<br>至此，flutter更新完成。若想使用低版本，把以上地址都改回去，然后package get一下即可。</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="http://b.nearby.ren/2021/05/31/mac flutter 支持多个版本配置/#comments" class="article-comment-link">评论</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-kotlin Android  day" class="article article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2021/04/25/kotlin Android  day/">kotlin Android day</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2021/04/25/kotlin Android  day/">
            <time datetime="2021-04-25T03:13:18.000Z" itemprop="datePublished">2021-04-25</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/kotlin/">kotlin</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/kotlin/">kotlin</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h3 id="kotlin-匿名-与-具名-函数使用"><a href="#kotlin-匿名-与-具名-函数使用" class="headerlink" title="kotlin 匿名 与 具名 函数使用"></a>kotlin 匿名 与 具名 函数使用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">fun main() &#123;</span><br><span class="line">    //匿名函数</span><br><span class="line">    showInfo(&quot;lr&quot;, &quot;男&quot;, 29) &#123;</span><br><span class="line">        println(&quot;$it&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">    //具名函数</span><br><span class="line">    showInfo(&quot;lr&quot;, &quot;男&quot;, 29, ::showResultImpl)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun showResultImpl(result: String) &#123;</span><br><span class="line">    println(result)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inline fun showInfo(name: String, sex: String, age: Int, showResult: (String) -&gt; Unit) &#123;</span><br><span class="line">    val str = &quot;显示信息  name =   $&#123;name&#125;   , sex = $&#123;sex&#125; , age =  $&#123;age&#125;&quot;</span><br><span class="line">    showResult(str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Java的实现方式"><a href="#Java的实现方式" class="headerlink" title="Java的实现方式"></a>Java的实现方式</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">public class ClassTest &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line"></span><br><span class="line">        //匿名实现方式</span><br><span class="line">        showInfo(&quot;lr&quot;, &quot;男&quot;, 29, new ShowResult() &#123;</span><br><span class="line"></span><br><span class="line">            @Override</span><br><span class="line">            public void show(String text) &#123;</span><br><span class="line">                System.out.println(text);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        //具体实现方式</span><br><span class="line">        ShowResultImpl showResult = new ShowResultImpl();</span><br><span class="line">        showInfo(&quot;lr&quot;, &quot;男&quot;, 29, showResult);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    static class ShowResultImpl implements ShowResult &#123;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void show(String text) &#123;</span><br><span class="line">            System.out.println(text);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void showInfo(String name, String sex, int age, ShowResult showResult) &#123;</span><br><span class="line">        String value = &quot;显示信息 name =   &quot; + name + &quot;   ,  sex =  &quot; + sex + &quot;  ,  age =  &quot; + age;</span><br><span class="line">        showResult.show(value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    interface ShowResult &#123;</span><br><span class="line">        void show(String text);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="【-】-安全调用操作符"><a href="#【-】-安全调用操作符" class="headerlink" title="【?】 安全调用操作符"></a>【?】 安全调用操作符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var  lr : String? = &quot; I&apos;m wang &quot;</span><br><span class="line"></span><br><span class="line">lr = null</span><br><span class="line"></span><br><span class="line">lr?.capitalize()//  lr是可空类型 可能是null 想要使用lr 必须给出补救措施</span><br><span class="line"></span><br><span class="line">lr?.capitalize()// lr是可空类型 如果真的是null   ?.后面的函数不执行，就不会引起空指针异常</span><br></pre></td></tr></table></figure>
<h3 id="【if】-安全调用操作符"><a href="#【if】-安全调用操作符" class="headerlink" title="【if】 安全调用操作符"></a>【if】 安全调用操作符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var lr: String? = &quot; I&apos;m wang &quot;</span><br><span class="line"></span><br><span class="line">lr = null</span><br><span class="line"></span><br><span class="line">if (lr != null) &#123;</span><br><span class="line">    val r = lr.capitalize()</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    println(lr)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="【-】-空合并操作符号"><a href="#【-】-空合并操作符号" class="headerlink" title="【?:】 空合并操作符号"></a>【?:】 空合并操作符号</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var lr: String? = &quot; I&apos;m wang &quot;</span><br><span class="line"></span><br><span class="line">lr = null</span><br><span class="line"></span><br><span class="line">//空合并操作符</span><br><span class="line">println(lr ?: &quot;I&apos;m wang &quot;)//如果lr等于null   就会执行?:后面的区域</span><br><span class="line"></span><br><span class="line">//let函数 + 空合并操作符</span><br><span class="line">println(lr ?.let&#123; &quot;[$it]&quot; &#125; ?: &quot;I&apos;m wang&quot;)//如果lr等于null  则不会执行.let&#123;&#125;函数   会执行?:后面的区域</span><br></pre></td></tr></table></figure>
<h3 id="【-】-非空断言操作符"><a href="#【-】-非空断言操作符" class="headerlink" title="【!!】 非空断言操作符"></a>【!!】 非空断言操作符</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">var  lr : String? = null</span><br><span class="line"></span><br><span class="line">lr = &quot; I&apos;m wang &quot;</span><br><span class="line"></span><br><span class="line">//lr是可空类型 可能是null 想要使用lr 必须给出补救措施</span><br><span class="line">val r = lr!!.capitalize()//  !!断言 不管lr是不是null 都执行，这个和java一样</span><br><span class="line"></span><br><span class="line">//如果百分百保证lr是有值，那么才可以使用断言!!</span><br></pre></td></tr></table></figure>
<h3 id="【let】-安全调用"><a href="#【let】-安全调用" class="headerlink" title="【let】 安全调用"></a>【let】 安全调用</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var lr: String? = null</span><br><span class="line">lr = &quot; I&apos;m wang &quot;</span><br><span class="line">//lr是可空类型 如果真的是null ?.后面的函数不执行，就不会引起空指针异常</span><br><span class="line">lr?.let &#123;</span><br><span class="line">    it == lr</span><br><span class="line">    //如果能够执行这里  it一定不为null</span><br><span class="line">    if (lr.isBlank()) &#123;</span><br><span class="line">        &quot;Default&quot;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">        it</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="【substring】截取字符串"><a href="#【substring】截取字符串" class="headerlink" title="【substring】截取字符串"></a>【substring】截取字符串</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">val subStr = &quot;I&apos;m lr&quot;</span><br><span class="line">val indexOf = subStr.indexOf(&apos; &apos;)</span><br><span class="line">println(subStr.substring(0, indexOf))</span><br><span class="line">println(subStr.substring(0 until indexOf))</span><br><span class="line"></span><br><span class="line">//输出如下</span><br><span class="line"></span><br><span class="line">I&apos;m</span><br><span class="line">I&apos;m</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
<h3 id="【split】分割字符串"><a href="#【split】分割字符串" class="headerlink" title="【split】分割字符串"></a>【split】分割字符串</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">val splitStr = &quot;I&apos;m,lr,wang,kotlin&quot;</span><br><span class="line">//splist 自动类型推断成 list = List&lt;String&gt;</span><br><span class="line">val splist = splitStr.split(&quot;,&quot;)</span><br><span class="line">println(&quot;分割后的list里面的元素有 $&#123;splist&#125;&quot;)</span><br><span class="line"></span><br><span class="line">//C++ 解构 kt解构</span><br><span class="line">val (v1, v2, v3, v4) = splist</span><br><span class="line">println(&quot;解构四个只读变量值是 $&#123;v1&#125;, $&#123;v2&#125;, $&#123;v3&#125;, $&#123;v4&#125;&quot;)</span><br><span class="line"></span><br><span class="line">//输出如下</span><br><span class="line"></span><br><span class="line">分割后的list里面的元素有 [I&apos;m, lr, wang, kotlin]</span><br><span class="line">解构四个只读变量值是 I&apos;m, lr, wang, kotlin</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
<h3 id="【replace】字符串完成加解密"><a href="#【replace】字符串完成加解密" class="headerlink" title="【replace】字符串完成加解密"></a>【replace】字符串完成加解密</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">val sourcePwd = &quot;ABCDEFGHIJKL&quot;</span><br><span class="line">   println(&quot;加密前处理 字符串 $&#123;sourcePwd&#125;&quot;)</span><br><span class="line"></span><br><span class="line">   val r = sourcePwd.replace(Regex(&quot;[ACEGI]&quot;)) &#123;</span><br><span class="line">       it.value</span><br><span class="line">       when (it.value) &#123;  //处理每一个字符</span><br><span class="line">           &quot;A&quot; -&gt; &quot;1&quot;</span><br><span class="line">           &quot;C&quot; -&gt; &quot;2&quot;</span><br><span class="line">           &quot;E&quot; -&gt; &quot;3&quot;</span><br><span class="line">           &quot;G&quot; -&gt; &quot;4&quot;</span><br><span class="line">           &quot;I&quot; -&gt; &quot;5&quot;</span><br><span class="line">           else -&gt; it.value //返回原始字符</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line">   println(&quot;加密后处理 字符串 $&#123;r&#125;&quot;)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   val r1 = r.replace(Regex(&quot;[12345]&quot;)) &#123;</span><br><span class="line">       it.value</span><br><span class="line">       when (it.value) &#123;  //处理每一个字符</span><br><span class="line">           &quot;1&quot; -&gt; &quot;A&quot;</span><br><span class="line">           &quot;2&quot; -&gt; &quot;C&quot;</span><br><span class="line">           &quot;3&quot; -&gt; &quot;E&quot;</span><br><span class="line">           &quot;4&quot; -&gt; &quot;G&quot;</span><br><span class="line">           &quot;5&quot; -&gt; &quot;I&quot;</span><br><span class="line">           else -&gt; it.value //返回原始字符</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   println(&quot;解密后处理 字符串 $&#123;r1&#125;&quot;)</span><br><span class="line"></span><br><span class="line">加密前处理 字符串 ABCDEFGHIJKL</span><br><span class="line">加密后处理 字符串 1B2D3F4H5JKL</span><br><span class="line">解密后处理 字符串 ABCDEFGHIJKL</span><br><span class="line"></span><br><span class="line">Process finished with exit code 0</span><br></pre></td></tr></table></figure>
<h3 id="【-】比较操作"><a href="#【-】比较操作" class="headerlink" title="【== ===】比较操作"></a>【== ===】比较操作</h3><p>// == 值  内容比较 相当于java的equals<br>// ===  引用的比较</p>
<h3 id="【apply】内置函数"><a href="#【apply】内置函数" class="headerlink" title="【apply】内置函数"></a>【apply】内置函数</h3><p>.apply返回的是自己本身 大部分的匿名函数都会返回it  而apply是持有this == 自己本身</p>
<h3 id="【let】内置函数"><a href="#【let】内置函数" class="headerlink" title="【let】内置函数"></a>【let】内置函数</h3><p>.let 匿名函数末尾行则作为返回值  let特点  返回类型: 根据函数末尾行返回的变化而变化</p>
<h4 id="let方式-空合并操作符-对值判null，并返回"><a href="#let方式-空合并操作符-对值判null，并返回" class="headerlink" title="let方式 +  空合并操作符  对值判null，并返回"></a>let方式 +  空合并操作符  对值判null，并返回</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fun loginApp(acc: String, pwd: String): Boolean &#123;</span><br><span class="line">    if (checkText(acc, &quot;请输入账户&quot;) == &quot;-1&quot;) return false</span><br><span class="line">    if (checkText(pwd, &quot;请输入密码&quot;) == &quot;-1&quot;) return false</span><br><span class="line">    return true</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun checkText(text: String, hint: String): String &#123;</span><br><span class="line">    return text?.let &#123;</span><br><span class="line">        &quot;-1&quot;</span><br><span class="line">    &#125; ?: hint</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="【run】内置函数"><a href="#【run】内置函数" class="headerlink" title="【run】内置函数"></a>【run】内置函数</h3><p>.run 根据函数末尾行返回的变化而变化  而run是持有this == 自己本身</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//输出</span><br><span class="line">&quot;请输入的信息必须是中文&quot;</span><br><span class="line">    .run(::isChinese)</span><br><span class="line">    .run(::isHint)</span><br><span class="line">    .run(::println)</span><br><span class="line"></span><br><span class="line">//取得返回值</span><br><span class="line">var str: String = &quot;请输入的信息必须是中文&quot;</span><br><span class="line">    .run(::isChinese)</span><br><span class="line">    .run(::isHint)</span><br><span class="line">    .run(::isRuHint)</span><br><span class="line"></span><br><span class="line">fun isChinese(text: String): Boolean &#123;</span><br><span class="line">    val reg = &quot;[\\u4e00-\\u9fa5]&quot;.toRegex()</span><br><span class="line">    return reg.containsMatchIn(text)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun isNumber(bol: Boolean): String &#123;</span><br><span class="line">    return if (bol) &quot;-1&quot; else &quot;请输入的信息必须是中文&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun isRuHint(str: String): String &#123;</span><br><span class="line">    return &quot;[$str]&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="主构造函数"><a href="#主构造函数" class="headerlink" title="主构造函数"></a>主构造函数</h3><h4 id="规范化写法"><a href="#规范化写法" class="headerlink" title="规范化写法"></a>规范化写法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">// _xxx都是 临时输入类型不能直接引用 需要临时变量接收</span><br><span class="line">class PersonInfo(_name: String, _age: String, _job: String) &#123;</span><br><span class="line"></span><br><span class="line">    private var name = _name</span><br><span class="line">        private set(value) &#123;</span><br><span class="line">            field = value</span><br><span class="line">        &#125;</span><br><span class="line">    private var age = _age</span><br><span class="line">        private set(value) &#123;</span><br><span class="line">            field = value</span><br><span class="line">        &#125;</span><br><span class="line">    private var job = _job</span><br><span class="line">        private set(value) &#123;</span><br><span class="line">            field = value</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    fun show() &#123;</span><br><span class="line">        println(&quot;$name ,$age , $job,&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="主构造函数里得属性"><a href="#主构造函数里得属性" class="headerlink" title="主构造函数里得属性"></a>主构造函数里得属性</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//  var name  就相当于   private var name = _name   的写法  得简洁写法</span><br><span class="line">class PersonInfo(var name: String, var age: String, var job: String) &#123;</span><br><span class="line"></span><br><span class="line">    fun show() &#123;</span><br><span class="line">        println(&quot;$name ,$age , $job,&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="次构造函数"><a href="#次构造函数" class="headerlink" title="次构造函数"></a>次构造函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">class PersonInfo(name: String) &#123;</span><br><span class="line"></span><br><span class="line">    constructor(name: String, age: String) : this(name) &#123;</span><br><span class="line">        println(&quot;2个参数的次构造函数 name:$name  ,sex:$age&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    constructor(name: String, age: String, job: String) : this(name) &#123;</span><br><span class="line">        println(&quot;3个参数的次构造函数 name:$name  ,sex:$age ,job:$job&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">    val lr = PersonInfo(&quot;lr&quot;)</span><br><span class="line">    PersonInfo(&quot;lr&quot;, &quot;16&quot;)</span><br><span class="line">    PersonInfo(&quot;lr&quot;, &quot;16&quot;, &quot;A股&quot;)</span><br><span class="line"></span><br><span class="line">//输出</span><br><span class="line"></span><br><span class="line">2个参数的次构造函数 name:lr  ,sex:16</span><br><span class="line">3个参数的次构造函数 name:lr  ,sex:16 ,job:A股</span><br></pre></td></tr></table></figure>
<h4 id="构造函数默认参数"><a href="#构造函数默认参数" class="headerlink" title="构造函数默认参数"></a>构造函数默认参数</h4><h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">class PersonInfo(_name: String, _age: String, _job: String) &#123;</span><br><span class="line"></span><br><span class="line">    //此次与Java对比   不是Java的static&#123;&#125;</span><br><span class="line">    //是相当于Java的&#123;&#125;代 码块</span><br><span class="line">    init &#123;  //1</span><br><span class="line">        println(&quot;主构造函数被调用了...&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    constructor(nickName: String) : this(nickName, &quot;19&quot;, &quot;A&quot;) &#123;</span><br><span class="line">        println(&quot;次构造函数被调用了...&quot;)//2</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    PersonInfo(&quot;lr&quot;, &quot;1&quot;, &quot;job&quot;)</span><br><span class="line">    println(&quot;...&quot;)</span><br><span class="line">    PersonInfo(&quot;io&quot;)</span><br><span class="line"></span><br><span class="line">//答应你打印顺序为</span><br><span class="line">主构造函数被调用了...</span><br><span class="line">...</span><br><span class="line">主构造函数被调用了...</span><br><span class="line">次构造函数被调用了...</span><br></pre></td></tr></table></figure>
<h4 id="函数执行顺序"><a href="#函数执行顺序" class="headerlink" title="函数执行顺序"></a>函数执行顺序</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">//第一步生成val job: String</span><br><span class="line">class PersonInfo(_name: String, _age: String, val _job: String) &#123;</span><br><span class="line"></span><br><span class="line">    //第二步:生成val job</span><br><span class="line">    val job = _job</span><br><span class="line"></span><br><span class="line">    //此次与Java对比   不是Java的static&#123;&#125;</span><br><span class="line">    //是相当于Java的&#123;&#125;代 码块</span><br><span class="line">    init &#123;  //1</span><br><span class="line">        val jobValue = _job //第三步:生成jobValue细节</span><br><span class="line">        println(&quot;主构造函数被调用了...$jobValue&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //次构造函数</span><br><span class="line">    constructor(nickName: String) : this(nickName, &quot;19&quot;, &quot;A&quot;) &#123;</span><br><span class="line">        //第四步:  生成次构造的细节</span><br><span class="line">        println(&quot;次构造函数被调用了...&quot;)//2</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">二三步骤是并行的 成员与init是同时生成的</span><br><span class="line">//细节 因为 val job = _job 在init前之前所以就会先生成，再到init。</span><br></pre></td></tr></table></figure>
<h4 id="延迟初始化lateinit学习"><a href="#延迟初始化lateinit学习" class="headerlink" title="延迟初始化lateinit学习"></a>延迟初始化lateinit学习</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">class LateinitClass &#123;</span><br><span class="line">    lateinit var job: String</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    fun request() &#123;</span><br><span class="line">        job = &quot;编程&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun showResponseResult() &#123;</span><br><span class="line"></span><br><span class="line">        //处理技巧</span><br><span class="line">        if (::job.isInitialized) println(&quot;showResponseResult $job&quot;) else println(&quot;你都没有初始化加载 &quot;)</span><br><span class="line"></span><br><span class="line">        //输出</span><br><span class="line">        println(&quot;showResponseResult $job&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//执行就会报错</span><br><span class="line">var lc = LateinitClass()</span><br><span class="line">lc.showResponseResult()</span><br><span class="line"></span><br><span class="line">//正确方式</span><br><span class="line">var lc = LateinitClass()</span><br><span class="line">lc.request()</span><br><span class="line">lc.showResponseResult()</span><br><span class="line"></span><br><span class="line">Exception in thread &quot;main&quot; kotlin.UninitializedPropertyAccessException: lateinit property job has not been initialized</span><br><span class="line">	at test.kotlin.LateinitClass.showResponseResult(ktFunction.kt:128)</span><br><span class="line">	at test.kotlin.KtFunctionKt.main(ktFunction.kt:115)</span><br><span class="line">	at test.kotlin.KtFunctionKt.main(ktFunction.kt)</span><br><span class="line"></span><br><span class="line">  因为你还没初始化 lateinit var job: String 就开始使用了。</span><br></pre></td></tr></table></figure>
<h4 id="惰性初始化-by-lazay"><a href="#惰性初始化-by-lazay" class="headerlink" title="惰性初始化 by lazay"></a>惰性初始化 by lazay</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class ByLazyClass &#123;</span><br><span class="line"></span><br><span class="line">  val dataBaseData1 = readSQLServerDatabase()//01</span><br><span class="line"></span><br><span class="line">    val dataBaseData by lazy &#123;</span><br><span class="line"></span><br><span class="line">        readSQLServerDatabase()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private fun readSQLServerDatabase() &#123;</span><br><span class="line">        println(&quot;开始启动操作......&quot;)</span><br><span class="line">        println(&quot;加载读取操作......&quot;)</span><br><span class="line">        println(&quot;加载读取操作......&quot;)</span><br><span class="line">        println(&quot;加载读取操作......&quot;)</span><br><span class="line">        println(&quot;加载读取操作......&quot;)</span><br><span class="line">        println(&quot;加载读取操作......&quot;)</span><br><span class="line">        println(&quot;结束所有操作......&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">//构建时候不会加载</span><br><span class="line">var bylazy = ByLazyClass() //此次构建得时候会执行 01处代码</span><br><span class="line">//开始使用才会加载</span><br><span class="line">bylazy.dataBaseData</span><br></pre></td></tr></table></figure>
<h4 id="初始化常见陷阱问题"><a href="#初始化常见陷阱问题" class="headerlink" title="初始化常见陷阱问题"></a>初始化常见陷阱问题</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//问题一</span><br><span class="line"></span><br><span class="line">class TextClass(_info: String) &#123;</span><br><span class="line"></span><br><span class="line">    //如下会报错     因为kotlin会严格按顺序执行下来的。</span><br><span class="line">    // variable cannot be initialized before declaration</span><br><span class="line">    //声明前不能初始化变量</span><br><span class="line"></span><br><span class="line">    init &#123;</span><br><span class="line">        number = number.times(9)</span><br><span class="line">    &#125;</span><br><span class="line">      private var number = 9</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//问题二</span><br><span class="line"></span><br><span class="line">class TextClass() &#123;</span><br><span class="line"></span><br><span class="line">    private val info: String  //01</span><br><span class="line"></span><br><span class="line">    init &#123;                  //02</span><br><span class="line">        getInfoMethod()</span><br><span class="line">        info = &quot;DerryOk&quot;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun getInfoMethod() &#123;     //03</span><br><span class="line">        println(&quot;info:$&#123;info[0]&#125;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//执行会报错 因为 TextClass()时候就会执行 02块 然后info还没被初始化就引用就会报错</span><br><span class="line"></span><br><span class="line">TextClass().getInfoMethod()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exception in thread &quot;main&quot; java.lang.NullPointerException</span><br><span class="line">	at test.kotlin.TextClass.getInfoMethod(ktFunction.kt:134)</span><br><span class="line">	at test.kotlin.TextClass.&lt;init&gt;(ktFunction.kt:129)</span><br><span class="line">	at test.kotlin.KtFunctionKt.main(ktFunction.kt:120)</span><br><span class="line">	at test.kotlin.KtFunctionKt.main(ktFunction.kt)</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//问题三</span><br><span class="line"></span><br><span class="line">class TextClass(_info: String) &#123;</span><br><span class="line">    val content: String = getInfoMethod()  //01</span><br><span class="line"></span><br><span class="line">    private val info = _info //02</span><br><span class="line"></span><br><span class="line">    private fun getInfoMethod() = info //03</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">println(&quot;内容的长度：$&#123;TextClass(&quot;test&quot;).content.length&#125;&quot;)</span><br><span class="line"></span><br><span class="line">//执行就会报错</span><br><span class="line">Exception in thread &quot;main&quot; java.lang.NullPointerException</span><br><span class="line">	at test.kotlin.KtFunctionKt.main(ktFunction.kt:118)</span><br><span class="line">	at test.kotlin.KtFunctionKt.main(ktFunction.kt)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//因为调用.content时候会执行 03 再执行 02 这时候info还未被初始化。</span><br><span class="line">解决方法就是将 02 与 01 顺序调换</span><br></pre></td></tr></table></figure>
<h4 id="kotlin的-继承"><a href="#kotlin的-继承" class="headerlink" title="kotlin的 继承"></a>kotlin的 继承</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//Kt所有的类，默认是final修饰的，不能被继承 与Java相反</span><br><span class="line">//通过关键字 open:移除final修饰</span><br><span class="line">open class PersonInfo(private val name: String) &#123;</span><br><span class="line"></span><br><span class="line">    fun showName() = &quot;父类 的姓名是 $name&quot;</span><br><span class="line"></span><br><span class="line">    open fun outInfo() = println(showName())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Student(private val subName: String) : PersonInfo(subName) &#123;</span><br><span class="line"></span><br><span class="line">    private fun showName() = &quot;子类 的姓名是 $subName&quot;</span><br><span class="line"></span><br><span class="line">    override fun outInfo() = println(showName())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//返回父类的引用 调用则返回是子类实现 因为重写了方法</span><br><span class="line">val personInfo: PersonInfo = Student(&quot;lr&quot;)</span><br><span class="line">personInfo.outInfo()</span><br></pre></td></tr></table></figure>
<h4 id="kotlin类型转换-【-is-as-】"><a href="#kotlin类型转换-【-is-as-】" class="headerlink" title="kotlin类型转换 【 is + as 】"></a>kotlin类型转换 【 is + as 】</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">//Kt所有的类，默认是final修饰的，不能被继承 与Java相反</span><br><span class="line">//通过关键字 open:移除final修饰</span><br><span class="line">open class PersonInfo(private val name: String) &#123;</span><br><span class="line"></span><br><span class="line">     fun showName1() = &quot;父类 的姓名是 $name&quot;</span><br><span class="line"></span><br><span class="line">    open fun outInfo() = println(showName1())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Student(private val subName: String) : PersonInfo(subName) &#123;</span><br><span class="line"></span><br><span class="line">    private fun showName() = &quot;子类 的姓名是 $subName&quot;</span><br><span class="line"></span><br><span class="line">    override fun outInfo() = println(showName())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">val personInfo: PersonInfo = Student(&quot;lr&quot;)</span><br><span class="line">personInfo.outInfo()</span><br><span class="line"></span><br><span class="line">if(personInfo is Student)&#123;</span><br><span class="line">     (personInfo as Student).outInfo()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if (personInfo is Student) &#123;</span><br><span class="line">    (personInfo as Student).outInfo()</span><br><span class="line">&#125;</span><br><span class="line">if (personInfo is PersonInfo) &#123;</span><br><span class="line">   println ((personInfo as PersonInfo).showName1())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">//输出</span><br><span class="line"></span><br><span class="line">子类 的姓名是 lr</span><br><span class="line">父类 的姓名是 lr</span><br></pre></td></tr></table></figure>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="http://b.nearby.ren/2021/04/25/kotlin Android  day/#comments" class="article-comment-link">评论</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-深入详解Apk编译打包流程" class="article article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2020/09/11/深入详解Apk编译打包流程/">深入详解Apk编译打包流程</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2020/09/11/深入详解Apk编译打包流程/">
            <time datetime="2020-09-11T04:13:18.000Z" itemprop="datePublished">2020-09-11</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/Android/">Android</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/Android/">Android</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="apk的编译流程"><a href="#apk的编译流程" class="headerlink" title="apk的编译流程"></a>apk的编译流程</h1><h2 id="1、apk文件"><a href="#1、apk文件" class="headerlink" title="1、apk文件"></a>1、apk文件</h2><p>.  apk是Android Package的缩写；<br>.  解压apk文件后包含AndroidManifest.xml、assets目录、classes.dex(还可能有 classes2.dex,classes3.dex…classesN.dex)、lib目录、META-INF目录、res目录和resources.arsc；<br>.  classes.dex 是.dex文件；<br>.  resources.arsc是resources resources文件；<br>.  AndroidManifest.xml是AndroidManifest.xml文件；<br>.  res是uncompiled resources；<br>.  META-INF是签名文件夹；</p>
<h2 id="2、打包流程"><a href="#2、打包流程" class="headerlink" title="2、打包流程"></a>2、打包流程</h2><p><img src="/2020/09/11/深入详解Apk编译打包流程/../../../../images/da13d22bc0414e93b22b822af1115d04.png" alt="Alt text"></p>
<h2 id="打包中需要的工具"><a href="#打包中需要的工具" class="headerlink" title="打包中需要的工具"></a>打包中需要的工具</h2><p>.  aapt：Android资源打包工具，${ANDROID_SDK_HOME}/platform-tools/appt<br>.  aidl：Android接口描述语言转化为.java文件的工具，${ANDROID_SDK_HOME}/platform-tools/aidl<br>.  javac：Java Compiler，${JDK_HOME}/javac或/usr/bin/javac<br>.  dex：转化.class文件为Davik VM能识别的.dex文件，${ANDROID_SDK_HOME}/platform-tools/dx<br>.  apkbuilder：生成apk包，${ANDROID_SDK_HOME}/tools/opkbuilder<br>.  jarsigner：.jar文件的签名工具，${JDK_HOME}/jarsigner或/usr/bin/jarsigner<br>.  zipalign：字节码对齐工具，${ANDROID_SDK_HOME}/tools/zipalign</p>
<h2 id="2-1打包资源文件，生成R-java文件"><a href="#2-1打包资源文件，生成R-java文件" class="headerlink" title="2.1打包资源文件，生成R.java文件"></a>2.1打包资源文件，生成R.java文件</h2><p>使用aapt来打包res资源文件，生成R.java、resources.arsc和res文件（二进制 &amp; 非二进制如res/raw和pic保持原样）；</p>
<h2 id="res目录"><a href="#res目录" class="headerlink" title="res目录"></a>res目录</h2><p>.  animator：这类资源以XML文件保存在res/animator目录下，用来描述属性动画；<br>.  anim：这类资源以XML文件保存在res/anim目录下，用来描述补间动画；<br>.  color：这类资源以XML文件保存在res/color目录下，用描述对象颜色状态选择子；<br>.  drawable：这类资源以XML或者Bitmap文件保存在res/drawable目录下，用来描述可绘制对象。例如，我们可以在里面放置一些图片（.png, .9.png, .jpg, .gif），来作为程序界面视图的背景图；<br>.  layout：这类资源以XML文件保存在res/layout目录下，用来描述应用程序界面布局；<br>.  menu：这类资源以XML文件保存在res/menu目录下，用来描述应用程序菜单；<br>.  raw：这类资源以任意格式的文件保存在res/raw目录下，它们和assets类资源一样，都是原装不动地打包在apk文件中的，不过它们会被赋予资源ID，这样我们就可以在程序中通过ID来访问它们。例如，假设在res/raw目录下有一个名称.  .  为filename的文件，并且它在编译的过程，被赋予的资源ID为R.raw.filename，那么就可以使用以下代码来访问它：<br>.  Resources res = getResources();<br>.  InputStream is = res .openRawResource(R.raw.filename);<br>.  values：这类资源以XML文件保存在res/values目录下，用来描述一些简单值，例如，数组、颜色、尺寸、字符串和样式值等，一般来说，这六种不同的值分别保存在名称为arrays.xml、colors.xml、dimens.xml、strings.xml.  和styles.xml文件中；<br>.  xml：这类资源以XML文件保存在res/xml目录下，一般就是用来描述应用程序的配置信息；</p>
<h2 id="resources-arsc文件"><a href="#resources-arsc文件" class="headerlink" title="resources.arsc文件"></a>resources.arsc文件</h2><p>.  resources.arsc这个文件记录了所有的应用程序资源目录的信息，包括每一个资源名称、类型、值、ID以及所配置的维度信息；<br>.  我们可以将这个resources.arsc文件想象成是一个资源索引表，这个资源索引表在给定资源ID和设备配置信息的情况下，能够在应用程序的资源目录中快速地找到最匹配的资源；</p>
<h2 id="R-java文件"><a href="#R-java文件" class="headerlink" title="R.java文件"></a>R.java文件</h2><p>.  R.java文件，里面拥有很多个静态内部类，比如layout，string等；<br>.  每当有这种资源添加时，就在R.java文件中添加一条静态内部类里的静态常量类成员，且所有成员都是int类型；</p>
<h2 id="2-2处理AIDL文件，生成对应的-java文件"><a href="#2-2处理AIDL文件，生成对应的-java文件" class="headerlink" title="2.2处理AIDL文件，生成对应的.java文件"></a>2.2处理AIDL文件，生成对应的.java文件</h2><p>.  AIDL （Android Interface Definition Language）， Android接口定义语言，Android提供的IPC （Inter Process Communication，进程间通信）的一种独特实现；<br>.  这个阶段处理.aidl文件，生成对应的Java接口文件；</p>
<h2 id="2-3编译Java文件，生成对应的-class文件"><a href="#2-3编译Java文件，生成对应的-class文件" class="headerlink" title="2.3编译Java文件，生成对应的.class文件"></a>2.3编译Java文件，生成对应的.class文件</h2><p>.  编译工程源码，生成相应的class文件。处理文件包括src、R.java、AIDL生成的 java 文件，库jar文件；<br>.  调用了javac编译工程的src目录下所有的java源文件，生成的class文件位于工程的bin\classess目录下；</p>
<h2 id="2-4把-class文件转化成Davik-VM支持的-dex文件"><a href="#2-4把-class文件转化成Davik-VM支持的-dex文件" class="headerlink" title="2.4把.class文件转化成Davik VM支持的.dex文件"></a>2.4把.class文件转化成Davik VM支持的.dex文件</h2><p>.  转换所有的class文件，生成classes.dex文件。处理文件就是上一步生成的 .class 文件；<br>.  使用dx工具将java字节码转换为dalvik字节码、压缩常量池、消除冗余信息等；<br>.  通过dex命令，将.class文件和第三方库中的.class文件处理生成classes.dex；</p>
<h2 id="2-5打包生成未签名的-apk文件"><a href="#2-5打包生成未签名的-apk文件" class="headerlink" title="2.5打包生成未签名的.apk文件"></a>2.5打包生成未签名的.apk文件</h2><p>将classes.dex、resources.arsc、res文件夹(res/raw资源被原装不动地打包进APK之外，其它的资源都会被编译或者处理)、Other Resources(assets文件夹)、AndroidManifest.xml打包成apk文件；<br>注意：</p>
<h2 id="res-raw和assets的相同点："><a href="#res-raw和assets的相同点：" class="headerlink" title="res/raw和assets的相同点："></a>res/raw和assets的相同点：</h2><p>两者目录下的文件在打包后会原封不动的保存在apk包中，不会被编译成二进制；</p>
<h2 id="res-raw和assets的不同点："><a href="#res-raw和assets的不同点：" class="headerlink" title="res/raw和assets的不同点："></a>res/raw和assets的不同点：</h2><p>.  res/raw中的文件会被映射到R.java文件中，访问的时候直接使用资源ID即R.id.filename；assets文件夹下的文件不会被映射到R.java中，访问的时候需要AssetManager类；<br>.  res/raw不可以有目录结构，而assets则可以有目录结构，也就是assets目录下可以再建立文件夹；</p>
<h2 id="2-6对未签名-apk文件进行签名"><a href="#2-6对未签名-apk文件进行签名" class="headerlink" title="2.6对未签名.apk文件进行签名"></a>2.6对未签名.apk文件进行签名</h2><p>.  android的应用程序需要签名才能在android设备上安装，签名apk文件有两种情况:<br>.  在调试应用程序时，也就是我们通常称为的debug模式的签名，平时开发的时候，在编译调试程序时会自己使用一个debug.keystore对apk进行签名；<br>.  正式发布时对应用程序打包进行签名，这种情况下需要提供一个符合android开发文档中要求的签名文件。这种签名也是分两种： JDK中提供的jarsigner工具签名 、android源码中提供的signapk工具；</p>
<h2 id="2-7对签名后的-apk文件进行对齐处理"><a href="#2-7对签名后的-apk文件进行对齐处理" class="headerlink" title="2.7对签名后的.apk文件进行对齐处理"></a>2.7对签名后的.apk文件进行对齐处理</h2><p>.  release mode 下使用 aipalign进行align，即对签名后的apk进行对齐处理；<br>.  Zipalign是一个android平台上整理APK文件的工具，它对apk中未压缩的数据进行4字节对齐，对齐后就可以使用mmap函数读取文件，可以像读取内存一样对普通文件进行操作。如果没有4字节对齐，就必须显式的读取，这样比较缓慢并且会耗费额外的内存；<br>.  在 Android SDK 中包含一个名为 “zipalign” 的工具，它能够对打包后的 app 进行优化。 其位于 SDK 的 build-tools 目录下；</p>
<p><img src="/2020/09/11/深入详解Apk编译打包流程/../../../../images/fa3b1a98d05f47aca59839bd6b412534.png" alt="Alt text"></p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="http://b.nearby.ren/2020/09/11/深入详解Apk编译打包流程/#comments" class="article-comment-link">评论</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-android 网络优化" class="article article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2020/03/31/android 网络优化/">android 网络优化</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2020/03/31/android 网络优化/">
            <time datetime="2020-03-31T01:12:23.000Z" itemprop="datePublished">2020-03-31</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/android/">android</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>, <a class="tag-link" href="/tags/性能优化/">性能优化</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>随着移动网络的不断升级，客户端的网络传输由3G进化到Wifi、4G，且Wifi场景越来越多。虽然网络环境在变好，但也对网络的应用提出了更高的要求，会发现很多大厂都十分重视网络指标，如果技术人员不加以控制，在弱网、体验、包括服务器带宽、流浪方面都会造成不同程度的损失。</p>
<h1 id="网络指标"><a href="#网络指标" class="headerlink" title="网络指标"></a>网络指标</h1><p>流量<br>网络第一个影响的app指标当然是流量，在手机设置界面可以清楚查看到每个 app 耗费的流量，极端情况下会造成用户卸载。</p>
<h1 id="电量"><a href="#电量" class="headerlink" title="电量"></a>电量</h1><p>频繁的网络请求和网络时常是引发电量的主要原因，每次发送请求都会激活电信号，同样耗电也会对用户产生恶略的影响，甚至卸载。</p>
<h1 id="用户体验"><a href="#用户体验" class="headerlink" title="用户体验"></a>用户体验</h1><p>一些网络框架会优化处理内部线程池，但线程池毕竟有限，网络请求过多或请求数据包体大，就会造成网络阻塞，也就是一些用户所谓的卡顿，在弱网方面可能表现更差，所以网络框架的好坏直接影响着整个app的用户体验。</p>
<h1 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h1><p>网络安全同样是网络优化中十分重要的一部分，怎样防止被第三方窃听/篡改或冒充，防止运营商劫持，同时又不影响性能，没有安全体系的网络架构同样会对服务端或者客户端造成直接或间接的影响。</p>
<h1 id="网络监控"><a href="#网络监控" class="headerlink" title="网络监控"></a>网络监控</h1><p>Network Monitor<br>Network Monitor Android Studio自带的网络监测工具，可以看出时间段之内的网络请求数量及访问速率。</p>
<p><img src="/2020/03/31/android 网络优化/../../../../images/iShot2021-10-0310.25.47.png" alt="Alt text"></p>
<h1 id="Charles-抓包工具"><a href="#Charles-抓包工具" class="headerlink" title="Charles 抓包工具"></a>Charles 抓包工具</h1><p>本人更习惯于使用 charles 进行网络监控，这可以查看更多的数据指标，查看请求request、response 更加直观。</p>
<p><img src="/2020/03/31/android 网络优化/../../../../images/iShot2021-10-0310.31.53.png" alt="Alt text"></p>
<h1 id="网络优化"><a href="#网络优化" class="headerlink" title="网络优化"></a>网络优化</h1><p>本人觉得网络优化主要从以下几个方面入手：</p>
<p>1.请求速度<br>2.链接成功率<br>3.流量消耗<br>4.安全策略</p>
<h1 id="网络请求过程："><a href="#网络请求过程：" class="headerlink" title="网络请求过程："></a>网络请求过程：</h1><p>1.DNS 解析，请求DNS服务器，获取IP地址<br>2.建立连接，包括 tcp 三次握手、安全协议<br>3.发送和接收数据，解码数据</p>
<h1 id="优化DNS解析"><a href="#优化DNS解析" class="headerlink" title="优化DNS解析"></a>优化DNS解析</h1><p>1.DNS解析在网路错误中占比较高，使用IP直连方式替代DNS服务器解析，可以减少域名解析几百毫秒的时间消耗。</p>
<h1 id="连接池复用"><a href="#连接池复用" class="headerlink" title="连接池复用"></a>连接池复用</h1><p>keep-alive HTTP 协议里有个 keep-alive，HTTP1.1默认开启，一定程度上缓解了每次请求都要进行TCP三次握手建立连接的耗时。原理是请求完成后不立即释放连接，而是放入连接池中，若这时有另一个请求要发出，请求的域名和端口是一样的，就直接拿出连接池中的连接进行发送和接收数据，少了建立连接的耗时。</p>
<h1 id="数据压缩"><a href="#数据压缩" class="headerlink" title="数据压缩"></a>数据压缩</h1><p>目前比较成熟的方案未 GZIP 压缩，正常情况下压缩率均值能打包 30-50之间，可以极大的提升传输速度和节省流量，必要是可以使用 Protocol Buffer 替换 JSON 。</p>
<h1 id="弱网优化"><a href="#弱网优化" class="headerlink" title="弱网优化"></a>弱网优化</h1><p>弱网优化，在弱网时要是制定合适的超时时间，控制网络并发，合并打包请求，调优TCP参数，使用TCP优化算法。<br>对服务端的TCP协议参数进行调优，以及开启各种优化算法，使得适合业务特性和移动端网络环境，包括RTO初始值，混合慢启动，TLP，F-RTO等。<br>针对弱网的这些细致优化暂未成为标准，开源网络库 mars 有实现可以借鉴，若有需要可以使用。</p>
<h1 id="网络安全"><a href="#网络安全" class="headerlink" title="网络安全"></a>网络安全</h1><p>1.采用 Https 双向认证<br>2.参数加密校验，防窃听/篡改或冒充<br>3.加密秘钥保护，采用 so 方式进行秘钥提取</p>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="http://b.nearby.ren/2020/03/31/android 网络优化/#comments" class="article-comment-link">评论</a>
    

        </footer>
    </div>
    
</article>



    <article id="post-View绘制主要要讲什么" class="article article-type-post" itemscope="" itemprop="blogPost">
    <div class="article-inner">
        
        
            <header class="article-header">
                
    
        <h1 itemprop="name">
            <a class="article-title" href="/2019/12/30/View绘制主要要讲什么/">View绘制主要要讲什么</a>
        </h1>
    

                
                    <div class="article-meta">
                        
    <div class="article-date">
        <i class="fa fa-calendar"></i>
        <a href="/2019/12/30/View绘制主要要讲什么/">
            <time datetime="2019-12-30T03:50:25.000Z" itemprop="datePublished">2019-12-30</time>
        </a>
    </div>


                        
    <div class="article-category">
    	<i class="fa fa-folder"></i>
        <a class="article-category-link" href="/categories/android/">android</a>
    </div>

                        
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/android/">android</a>
    </div>

                    </div>
                
            </header>
        
        
        <div class="article-entry" itemprop="articleBody">
        
            
            <h1 id="View的绘制流程是程序开发的必备知识，也是面试经常会问到知识"><a href="#View的绘制流程是程序开发的必备知识，也是面试经常会问到知识" class="headerlink" title="View的绘制流程是程序开发的必备知识，也是面试经常会问到知识"></a>View的绘制流程是程序开发的必备知识，也是面试经常会问到知识</h1><ul>
<li>View绘制如下图<br><img src="/2019/12/30/View绘制主要要讲什么/../../../../images/25222288-0f49881c84a47af3.webp" alt="Alt text"></li>
</ul>
<p>简单回答就是 measure，layout，draw 分别对应测量，布局，绘制三个过程。<br>涉及到更深的知识就会引申到Handler，同步屏障，View 的事件传递，甚至 activity 的启动过程。</p>
<h1 id="什么是-ViewRootImpl"><a href="#什么是-ViewRootImpl" class="headerlink" title="什么是 ViewRootImpl"></a>什么是 ViewRootImpl</h1><p>相比 Viewgroup 和 View，ViewRootImpl 可能更为陌生，实际开发中我们基本用不到它。那么</p>
<p>从结构上来看，ViewRootImpl 和 ViewGroup 其实是一种东西</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public final class ViewRootImpl implements ViewParent,</span><br><span class="line">        View.AttachInfo.Callbacks, ThreadedRenderer.DrawCallbacks &#123;&#125;</span><br><span class="line">public abstract class ViewGroup extends View </span><br><span class="line">        implements ViewParent, ViewManager &#123;&#125;</span><br></pre></td></tr></table></figure>
<p>它们都继承了 ViewParent。ViewParent 是一个接口，定义了一些父 View 的基本行为，比如 requestlayout，getparent 等。不同的是，ViewRootImpl 并不会像 ViewGroup 一样被真正绘制在屏幕上。在 activity 中，它是专门用来绘制 DecorView 的，核心方法是 setView</p>
<ul>
<li>“activity，window，View 三者之间的关系是什么？”</li>
</ul>
<p><img src="/2019/12/30/View绘制主要要讲什么/../../../../images/25222288-2f699c1ecb3e373e.webp" alt="Alt text"></p>
<p>如图所示，window 是 activity 里的一个实例变量，本质是一个接口，唯一的实现类是 PhoneWindow。</p>
<p>activity 的 setContentView 方法实际上是就是交给 phonewindow 去做的。window 和 View 的关系可以类比为显示器和显示的内容。</p>
<p>每个 activity 都有一个“显示器” window，“显示的内容”就是 DecorView。这个“显示器”定义了一些方法来决定如何显示内容。比如 setTitleColor setTitle 是设置导航栏的颜色和 title , setAllowReturnTransitionOverlap 设置进/出场动画等等。</p>
<p>所以 window 是 activity 的一个成员变量，window 和 View 是“显示器”和“显示内容”的关系。</p>
<p>这就是他们的关系</p>
<p>在整个 activity 的生命周期中，setContentView 是在 onCreate 中调用的，它实现了对资源文件的解析，完成了 xml 文件到 View 的转化。那么 View 真正开始绘制是在哪个生命周期呢？</p>
<ul>
<li>答案是 onResume 结束后</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public void handleResumeActivity(IBinder token, boolean finalStateRequest, boolean isForward,</span><br><span class="line">            String reason) &#123;</span><br><span class="line">        // If we are getting ready to gc after going to the background, well</span><br><span class="line">        // we are back active so skip it.</span><br><span class="line">        unscheduleGcIdler();</span><br><span class="line">        mSomeActivitiesChanged = true;</span><br><span class="line"></span><br><span class="line">        // 1. 执行Activity的onResume方法</span><br><span class="line">        final ActivityClientRecord r = performResumeActivity(token, finalStateRequest, reason);</span><br><span class="line">        if (r == null) &#123;</span><br><span class="line">            // We didn&apos;t actually resume the activity, so skipping any follow-up actions.</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        if (mActivitiesToBeDestroyed.containsKey(token)) &#123;</span><br><span class="line">            // Although the activity is resumed, it is going to be destroyed. So the following</span><br><span class="line">            // UI operations are unnecessary and also prevents exception because its token may</span><br><span class="line">            // be gone that window manager cannot recognize it. All necessary cleanup actions</span><br><span class="line">            // performed below will be done while handling destruction.</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        final Activity a = r.activity;</span><br><span class="line"></span><br><span class="line">        if (localLOGV) &#123;</span><br><span class="line">            Slog.v(TAG, &quot;Resume &quot; + r + &quot; started activity: &quot; + a.mStartedActivity</span><br><span class="line">                    + &quot;, hideForNow: &quot; + r.hideForNow + &quot;, finished: &quot; + a.mFinished);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        final int forwardBit = isForward</span><br><span class="line">                ? WindowManager.LayoutParams.SOFT_INPUT_IS_FORWARD_NAVIGATION : 0;</span><br><span class="line"></span><br><span class="line">        // If the window hasn&apos;t yet been added to the window manager,</span><br><span class="line">        // and this guy didn&apos;t finish itself or start another activity,</span><br><span class="line">        // then go ahead and add the window.</span><br><span class="line">        boolean willBeVisible = !a.mStartedActivity;</span><br><span class="line">        if (!willBeVisible) &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                willBeVisible = ActivityTaskManager.getService().willActivityBeVisible(</span><br><span class="line">                        a.getActivityToken());</span><br><span class="line">            &#125; catch (RemoteException e) &#123;</span><br><span class="line">                throw e.rethrowFromSystemServer();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (r.window == null &amp;&amp; !a.mFinished &amp;&amp; willBeVisible) &#123;</span><br><span class="line">            // 2. 获取window</span><br><span class="line">            r.window = r.activity.getWindow();</span><br><span class="line">            // 3. 获取DecorView</span><br><span class="line">            View decor = r.window.getDecorView();</span><br><span class="line">            decor.setVisibility(View.INVISIBLE);</span><br><span class="line">            // 4.获取Activity的WindowManager</span><br><span class="line">            ViewManager wm = a.getWindowManager();</span><br><span class="line">            WindowManager.LayoutParams l = r.window.getAttributes();</span><br><span class="line">            a.mDecor = decor;</span><br><span class="line">            l.type = WindowManager.LayoutParams.TYPE_BASE_APPLICATION;</span><br><span class="line">            l.softInputMode |= forwardBit;</span><br><span class="line">            if (r.mPreserveWindow) &#123;</span><br><span class="line">                a.mWindowAdded = true;</span><br><span class="line">                r.mPreserveWindow = false;</span><br><span class="line">                // Normally the ViewRoot sets up callbacks with the Activity</span><br><span class="line">                // in addView-&gt;ViewRootImpl#setView. If we are instead reusing</span><br><span class="line">                // the decor view we have to notify the view root that the</span><br><span class="line">                // callbacks may have changed.</span><br><span class="line">                ViewRootImpl impl = decor.getViewRootImpl();</span><br><span class="line">                if (impl != null) &#123;</span><br><span class="line">                    impl.notifyChildRebuilt();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (a.mVisibleFromClient) &#123;</span><br><span class="line">                if (!a.mWindowAdded) &#123;</span><br><span class="line">                    a.mWindowAdded = true;</span><br><span class="line">                    // 5.调用WindowManager的addView方法</span><br><span class="line">                    wm.addView(decor, l);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    // The activity will get a callback for this &#123;@link LayoutParams&#125; change</span><br><span class="line">                    // earlier. However, at that time the decor will not be set (this is set</span><br><span class="line">                    // in this method), so no action will be taken. This call ensures the</span><br><span class="line">                    // callback occurs with the decor set.</span><br><span class="line">                    a.onWindowAttributesChanged(l);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // If the window has already been added, but during resume</span><br><span class="line">            // we started another activity, then don&apos;t yet make the</span><br><span class="line">            // window visible.</span><br><span class="line">        &#125; else if (!willBeVisible) &#123;</span><br><span class="line">            if (localLOGV) Slog.v(TAG, &quot;Launch &quot; + r + &quot; mStartedActivity set&quot;);</span><br><span class="line">            r.hideForNow = true;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        // Get rid of anything left hanging around.</span><br><span class="line">        cleanUpPendingRemoveWindows(r, false /* force */);</span><br><span class="line"></span><br><span class="line">        // The window is now visible if it has been added, we are not</span><br><span class="line">        // simply finishing, and we are not starting another activity.</span><br><span class="line">        if (!r.activity.mFinished &amp;&amp; willBeVisible &amp;&amp; r.activity.mDecor != null &amp;&amp; !r.hideForNow) &#123;</span><br><span class="line">            if (r.newConfig != null) &#123;</span><br><span class="line">                performConfigurationChangedForActivity(r, r.newConfig);</span><br><span class="line">                if (DEBUG_CONFIGURATION) &#123;</span><br><span class="line">                    Slog.v(TAG, &quot;Resuming activity &quot; + r.activityInfo.name + &quot; with newConfig &quot;</span><br><span class="line">                            + r.activity.mCurrentConfig);</span><br><span class="line">                &#125;</span><br><span class="line">                r.newConfig = null;</span><br><span class="line">            &#125;</span><br><span class="line">            if (localLOGV) Slog.v(TAG, &quot;Resuming &quot; + r + &quot; with isForward=&quot; + isForward);</span><br><span class="line">            ViewRootImpl impl = r.window.getDecorView().getViewRootImpl();</span><br><span class="line">            WindowManager.LayoutParams l = impl != null</span><br><span class="line">                    ? impl.mWindowAttributes : r.window.getAttributes();</span><br><span class="line">            if ((l.softInputMode</span><br><span class="line">                    &amp; WindowManager.LayoutParams.SOFT_INPUT_IS_FORWARD_NAVIGATION)</span><br><span class="line">                    != forwardBit) &#123;</span><br><span class="line">                l.softInputMode = (l.softInputMode</span><br><span class="line">                        &amp; (~WindowManager.LayoutParams.SOFT_INPUT_IS_FORWARD_NAVIGATION))</span><br><span class="line">                        | forwardBit;</span><br><span class="line">                if (r.activity.mVisibleFromClient) &#123;</span><br><span class="line">                    ViewManager wm = a.getWindowManager();</span><br><span class="line">                    View decor = r.window.getDecorView();</span><br><span class="line">                    wm.updateViewLayout(decor, l);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            r.activity.mVisibleFromServer = true;</span><br><span class="line">            mNumVisibleActivities++;</span><br><span class="line">            if (r.activity.mVisibleFromClient) &#123;</span><br><span class="line">                r.activity.makeVisible();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        r.nextIdle = mNewActivities;</span><br><span class="line">        mNewActivities = r;</span><br><span class="line">        if (localLOGV) Slog.v(TAG, &quot;Scheduling idle handler for &quot; + r);</span><br><span class="line">        Looper.myQueue().addIdleHandler(new Idler());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public void addView(View view, ViewGroup.LayoutParams params,</span><br><span class="line">            Display display, Window parentWindow, int userId) &#123;</span><br><span class="line">        if (view == null) &#123;</span><br><span class="line">            throw new IllegalArgumentException(&quot;view must not be null&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (display == null) &#123;</span><br><span class="line">            throw new IllegalArgumentException(&quot;display must not be null&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        if (!(params instanceof WindowManager.LayoutParams)) &#123;</span><br><span class="line">            throw new IllegalArgumentException(&quot;Params must be WindowManager.LayoutParams&quot;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        final WindowManager.LayoutParams wparams = (WindowManager.LayoutParams) params;</span><br><span class="line">        if (parentWindow != null) &#123;</span><br><span class="line">            parentWindow.adjustLayoutParamsForSubWindow(wparams);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            // If there&apos;s no parent, then hardware acceleration for this view is</span><br><span class="line">            // set from the application&apos;s hardware acceleration setting.</span><br><span class="line">            final Context context = view.getContext();</span><br><span class="line">            if (context != null</span><br><span class="line">                    &amp;&amp; (context.getApplicationInfo().flags</span><br><span class="line">                            &amp; ApplicationInfo.FLAG_HARDWARE_ACCELERATED) != 0) &#123;</span><br><span class="line">                wparams.flags |= WindowManager.LayoutParams.FLAG_HARDWARE_ACCELERATED;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ViewRootImpl root;</span><br><span class="line">        View panelParentView = null;</span><br><span class="line"></span><br><span class="line">        synchronized (mLock) &#123;</span><br><span class="line">            // Start watching for system property changes.</span><br><span class="line">            if (mSystemPropertyUpdater == null) &#123;</span><br><span class="line">                mSystemPropertyUpdater = new Runnable() &#123;</span><br><span class="line">                    @Override public void run() &#123;</span><br><span class="line">                        synchronized (mLock) &#123;</span><br><span class="line">                            for (int i = mRoots.size() - 1; i &gt;= 0; --i) &#123;</span><br><span class="line">                                mRoots.get(i).loadSystemProperties();</span><br><span class="line">                            &#125;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;;</span><br><span class="line">                SystemProperties.addChangeCallback(mSystemPropertyUpdater);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            int index = findViewLocked(view, false);</span><br><span class="line">            if (index &gt;= 0) &#123;</span><br><span class="line">                if (mDyingViews.contains(view)) &#123;</span><br><span class="line">                    // Don&apos;t wait for MSG_DIE to make it&apos;s way through root&apos;s queue.</span><br><span class="line">                    mRoots.get(index).doDie();</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    throw new IllegalStateException(&quot;View &quot; + view</span><br><span class="line">                            + &quot; has already been added to the window manager.&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">                // The previous removeView() had not completed executing. Now it has.</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // If this is a panel window, then find the window it is being</span><br><span class="line">            // attached to for future reference.</span><br><span class="line">            if (wparams.type &gt;= WindowManager.LayoutParams.FIRST_SUB_WINDOW &amp;&amp;</span><br><span class="line">                    wparams.type &lt;= WindowManager.LayoutParams.LAST_SUB_WINDOW) &#123;</span><br><span class="line">                final int count = mViews.size();</span><br><span class="line">                for (int i = 0; i &lt; count; i++) &#123;</span><br><span class="line">                    if (mRoots.get(i).mWindow.asBinder() == wparams.token) &#123;</span><br><span class="line">                        panelParentView = mViews.get(i);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            root = new ViewRootImpl(view.getContext(), display);</span><br><span class="line"></span><br><span class="line">            view.setLayoutParams(wparams);</span><br><span class="line"></span><br><span class="line">            mViews.add(view);</span><br><span class="line">            mRoots.add(root);</span><br><span class="line">            mParams.add(wparams);</span><br><span class="line"></span><br><span class="line">            // do this last because it fires off messages to start doing things</span><br><span class="line">            try &#123;</span><br><span class="line">                // 6.调用viewRootImpl的setView方法</span><br><span class="line">                root.setView(view, wparams, panelParentView, userId);</span><br><span class="line">            &#125; catch (RuntimeException e) &#123;</span><br><span class="line">                // BadTokenException or InvalidDisplayException, clean up.</span><br><span class="line">                if (index &gt;= 0) &#123;</span><br><span class="line">                    removeViewLocked(index, true);</span><br><span class="line">                &#125;</span><br><span class="line">                throw e;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>从源码中可以看到，onResume 之后，ActivityThread 通过调用 activity 中 windowmanager 的 addView 方法，将 decorView 传入到 ViewRootImpl 的 setView 方法中，通过 setView 来完成 View 的绘制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">//接收的参数ViewRootImpl#setView 这里入参是DecorView</span><br><span class="line">public void setView(View view, WindowManager.LayoutParams attrs, View panelParentView,</span><br><span class="line">        int userId) &#123;</span><br><span class="line">            ....</span><br><span class="line">            // Schedule the first layout -before- adding to the window</span><br><span class="line">            // manager, to make sure we do the relayout before receiving</span><br><span class="line">            // any other events from the system.</span><br><span class="line">            //检查绘制的的线程是不是创建View的线程 绘制View</span><br><span class="line">            requestLayout();</span><br><span class="line">            ....</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">public void requestLayout() &#123;</span><br><span class="line">    if (!mHandlingLayoutInLayoutRequest) &#123;</span><br><span class="line">        //线程检查</span><br><span class="line">        checkThread();</span><br><span class="line">        mLayoutRequested = true;</span><br><span class="line">        //开始绘制</span><br><span class="line">        scheduleTraversals();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@UnsupportedAppUsage</span><br><span class="line">void scheduleTraversals() &#123;</span><br><span class="line">    if (!mTraversalScheduled) &#123;</span><br><span class="line">        mTraversalScheduled = true;</span><br><span class="line">        //获取内存屏障</span><br><span class="line">        mTraversalBarrier = mHandler.getLooper().getQueue().postSyncBarrier();</span><br><span class="line">        //执行绘制任务 mTraversalBarrier</span><br><span class="line">        mChoreographer.postCallback(</span><br><span class="line">                Choreographer.CALLBACK_TRAVERSAL, mTraversalRunnable, null);</span><br><span class="line">        notifyRendererOfFramePending();</span><br><span class="line">        pokeDrawLockIfNeeded();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void doTraversal() &#123;</span><br><span class="line">    if (mTraversalScheduled) &#123;</span><br><span class="line">        mTraversalScheduled = false;</span><br><span class="line">        //移除内存屏障</span><br><span class="line">        mHandler.getLooper().getQueue().removeSyncBarrier(mTraversalBarrier);</span><br><span class="line"></span><br><span class="line">        if (mProfile) &#123;</span><br><span class="line">            Debug.startMethodTracing(&quot;ViewAncestor&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        //开始绘制 依次调用performMeasure performLayout performDraw</span><br><span class="line">        performTraversals();</span><br><span class="line"></span><br><span class="line">        if (mProfile) &#123;</span><br><span class="line">            Debug.stopMethodTracing();</span><br><span class="line">            mProfile = false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>简单来说 setView 做了三件事</li>
</ul>
<ol>
<li><p>检查绘制的线程是不是创建 View 的线程。这里可以引申出一个问题，View 的绘制必须在主线程吗？</p>
</li>
<li><p>通过内存屏障保证绘制 View 的任务是最优先的</p>
</li>
<li><p>调用 performTraversals 完成 measure，layout，draw 的绘制</p>
</li>
</ol>
<p>看到这里，ViewRootImpl 的绘制基本就完成了。其实这也是面试官希望听到的内容。考察的是面试者对 View 绘制体系的理解。</p>
<p>后续 ViewGroup 和 View 的绘制其实是 performTraversals 对整个 ViewTree 的绘制。他们的关系可以用下面这张图表示</p>
<p><img src="/2019/12/30/View绘制主要要讲什么/../../../../images/25222288-5514a7569242ba6f.webp" alt="Alt text"></p>
<h1 id="那为什么我在-onCreate-中调用-View-post-方法可以得到-View-的宽高呢"><a href="#那为什么我在-onCreate-中调用-View-post-方法可以得到-View-的宽高呢" class="headerlink" title="那为什么我在 onCreate 中调用 View.post 方法可以得到 View 的宽高呢?"></a>那为什么我在 onCreate 中调用 View.post 方法可以得到 View 的宽高呢?</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public boolean post(Runnable action) &#123;</span><br><span class="line">    final AttachInfo attachInfo = mAttachInfo;</span><br><span class="line">    if (attachInfo != null) &#123;</span><br><span class="line">        return attachInfo.mHandler.post(action);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Postpone the runnable until we know on which thread it needs to run.</span><br><span class="line">    // Assume that the runnable will be successfully placed after attach.</span><br><span class="line">    getRunQueue().post(action);</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>View.post 会判断当前 View 是否已经被添加到 window 上。如果添加了则立即执行 runnable，如果没有被添加则先放到一个队列中存储起来，等添加到 window 上时再执行。</p>
<p>而 View 被测量完成后才会 attachToWindow。所以当 post 的 runnable 执行时，View 已经绘制完成了。</p>
<h1 id="MeasureSpec-的理解"><a href="#MeasureSpec-的理解" class="headerlink" title="MeasureSpec 的理解"></a>MeasureSpec 的理解</h1><ul>
<li>说说什么是 MeasureSpec？为什么测量宽高要用它作为参数呢？</li>
</ul>
<p>View 的大小不仅仅取决于自身的宽高，还取决于父 View 的大小和测量模式。一个 200200 的父 View 是不可能容纳一个 300300 的子 View 的，父 View 的 wrap_content 和 match_content 也会影响子 View 的大小。</p>
<p>所以 View 的 measure 函数其实应该有 4 个参数：父 View 的宽，父 View 的高，宽的测量模式，高的测量模式。</p>
<p>Android 这里用了一个巧妙的设计，用一个 Int 值来表示宽/高的测量模式和大小。一个 int 有 32 位，前 2 位表示测量 MODE，后 30 位表示 SIZE。</p>
<p>为什么要用 2 位表示 MODE 呢？因为 MODE 只有 3 种呀，UNSPECIFIED，EXACTLY，AT_MOST 。</p>
<ul>
<li>使用这个 View 时宽高传入 wrap_content，结果会怎么样？</li>
</ul>
<p>当我们自定义一个 View 时，如果继承的是 View，measure 方法走的就是 View 默认的逻辑</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</span><br><span class="line">    setMeasuredDimension(getDefaultSize(getSuggestedMinimumWidth(), widthMeasureSpec),</span><br><span class="line">            getDefaultSize(getSuggestedMinimumHeight(), heightMeasureSpec));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public static int getDefaultSize(int size, int measureSpec) &#123;</span><br><span class="line">    int result = size;</span><br><span class="line">    int specMode = MeasureSpec.getMode(measureSpec);</span><br><span class="line">    int specSize = MeasureSpec.getSize(measureSpec);</span><br><span class="line"></span><br><span class="line">    switch (specMode) &#123;</span><br><span class="line">    case MeasureSpec.UNSPECIFIED:</span><br><span class="line">        result = size;</span><br><span class="line">        break;</span><br><span class="line">    case MeasureSpec.AT_MOST:</span><br><span class="line">    case MeasureSpec.EXACTLY:</span><br><span class="line">        result = specSize;</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>所以当我们自定义 View 时，如果没有对 MODE 做处理，设置 wrap_content 和 match_content 结果其实是一样的，View 的宽高都是取父 View 的宽高。</p>
<ul>
<li>invaliate 和 requestlayout 方法的区别?</li>
</ul>
<p>ViewRootImpl 作为顶级 View 负责 View 的绘制。所以简单来说，requestlayout 和 invaliate 最终都会向上回溯调用到 ViewRootImpl 的 postTranversals 方法来绘制 View。</p>
<p>不同的是 requestlayout 会绘制 View 的 measure，layout 和 draw 过程。invaliate 因为只添加了绘制 draw 的标志位，只会绘制 draw 过程。</p>
<ul>
<li>实现一下 findViewbyid 的过程?</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">View findViewById(int id)&#123;</span><br><span class="line">    if(mId == id)return  this;</span><br><span class="line">    if(mVIew instanceof ViewGroup)&#123;</span><br><span class="line">        int childrenCount = getChildrenCount();</span><br><span class="line">        for(int i = 0; i&lt;childrenCount;i++)&#123;</span><br><span class="line">            View v = getchildAt(i)&#123;</span><br><span class="line">                v = v.findViewById(id);</span><br><span class="line">                if(v !=null)&#123;</span><br><span class="line">                    return  v;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

        
        </div>
        <footer class="article-footer">
            <div class="share-container">



</div>

            
    
        <a href="http://b.nearby.ren/2019/12/30/View绘制主要要讲什么/#comments" class="article-comment-link">评论</a>
    

        </footer>
    </div>
    
</article>



    <nav id="page-nav">
        <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/19/">19</a><a class="extend next" rel="next" href="/page/2/">下一页 &raquo;</a>
    </nav>
</section>
            
                <aside id="sidebar">
   
        
    <div class="widget-wrap">
        <h3 class="widget-title">最新文章</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/05/31/mac flutter 支持多个版本配置/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/android/">android</a></p>
                            <p class="item-title"><a href="/2021/05/31/mac flutter 支持多个版本配置/" class="title">mac flutter 支持多个版本配置</a></p>
                            <p class="item-date"><time datetime="2021-05-31T01:47:42.000Z" itemprop="datePublished">2021-05-31</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2021/04/25/kotlin Android  day/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/kotlin/">kotlin</a></p>
                            <p class="item-title"><a href="/2021/04/25/kotlin Android  day/" class="title">kotlin Android day</a></p>
                            <p class="item-date"><time datetime="2021-04-25T03:13:18.000Z" itemprop="datePublished">2021-04-25</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2020/09/11/深入详解Apk编译打包流程/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Android/">Android</a></p>
                            <p class="item-title"><a href="/2020/09/11/深入详解Apk编译打包流程/" class="title">深入详解Apk编译打包流程</a></p>
                            <p class="item-date"><time datetime="2020-09-11T04:13:18.000Z" itemprop="datePublished">2020-09-11</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2020/03/31/android 网络优化/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/android/">android</a></p>
                            <p class="item-title"><a href="/2020/03/31/android 网络优化/" class="title">android 网络优化</a></p>
                            <p class="item-date"><time datetime="2020-03-31T01:12:23.000Z" itemprop="datePublished">2020-03-31</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2019/12/30/View绘制主要要讲什么/" class="thumbnail">
    
    
        <span class="thumbnail-image thumbnail-none"></span>
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/android/">android</a></p>
                            <p class="item-title"><a href="/2019/12/30/View绘制主要要讲什么/" class="title">View绘制主要要讲什么</a></p>
                            <p class="item-date"><time datetime="2019-12-30T03:50:25.000Z" itemprop="datePublished">2019-12-30</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">分类</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Android/">Android</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/EventBus/">EventBus</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/RecyclerView/">RecyclerView</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/android/">android</a><span class="category-list-count">30</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/android-studio/">android studio</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/apk/">apk</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/dagger2/">dagger2</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/flutter/">flutter</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/git/">git</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/go/">go</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/gradle/">gradle</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/hexo/">hexo</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/java/">java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/kotlin/">kotlin</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/linxu/">linxu</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mac/">mac</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/markdown/">markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/mvp/">mvp</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/offce/">offce</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/resume/">resume</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/rxjava/">rxjava</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/spring/">spring</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/tinker/">tinker</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/vuforia/">vuforia</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/web/">web</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/延迟搜索/">延迟搜索</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/文字/">文字</a><span class="category-list-count">7</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/软件/">软件</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/适配/">适配</a><span class="category-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">归档</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/05/">五月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/04/">四月 2021</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">十一月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">九月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">六月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">四月 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">三月 2017</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">二月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">一月 2017</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">十二月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">十一月 2016</a><span class="archive-list-count">5</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">十月 2016</a><span class="archive-list-count">9</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">九月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">八月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/07/">七月 2016</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">六月 2016</a><span class="archive-list-count">6</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">四月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">三月 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/02/">二月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/01/">一月 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">十二月 2015</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/11/">十一月 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/10/">十月 2015</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">九月 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/06/">六月 2015</a><span class="archive-list-count">2</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签</h3>
        <div class="widget">
            <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Android/">Android</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Leakcanary/">Leakcanary</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Mac-Linux/">Mac/Linux</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/">android</a><span class="tag-list-count">39</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android-studio/">android studio</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/bug/">bug</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dagger2/">dagger2</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flutter/">flutter</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/">git</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/glide/">glide</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/">go</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/golang/">golang</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle/">gradle</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/h5/">h5</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/https/">https</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ios/">ios</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kotlin/">kotlin</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linxu/">linxu</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mac/">mac</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mvp/">mvp</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/offce/">offce</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/resume/">resume</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rxandroid/">rxandroid</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rxjava/">rxjava</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/service/">service</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/">springboot</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/view/">view</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vuforia/">vuforia</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/延迟/">延迟</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/性能优化/">性能优化</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文字/">文字</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/歌曲/">歌曲</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/直播/">直播</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/笔录/">笔录</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/算法/">算法</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/软件名词/">软件名词</a><span class="tag-list-count">1</span></li></ul>
        </div>
    </div>

    
        
    <div class="widget-wrap">
        <h3 class="widget-title">标签云</h3>
        <div class="widget tagcloud">
            <a href="/tags/Android/" style="font-size: 15px;">Android</a> <a href="/tags/Leakcanary/" style="font-size: 10px;">Leakcanary</a> <a href="/tags/Mac-Linux/" style="font-size: 10px;">Mac/Linux</a> <a href="/tags/android/" style="font-size: 20px;">android</a> <a href="/tags/android-studio/" style="font-size: 10px;">android studio</a> <a href="/tags/bug/" style="font-size: 10px;">bug</a> <a href="/tags/dagger2/" style="font-size: 11.67px;">dagger2</a> <a href="/tags/flutter/" style="font-size: 10px;">flutter</a> <a href="/tags/git/" style="font-size: 16.67px;">git</a> <a href="/tags/glide/" style="font-size: 15px;">glide</a> <a href="/tags/go/" style="font-size: 18.33px;">go</a> <a href="/tags/golang/" style="font-size: 10px;">golang</a> <a href="/tags/gradle/" style="font-size: 11.67px;">gradle</a> <a href="/tags/h5/" style="font-size: 10px;">h5</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/https/" style="font-size: 11.67px;">https</a> <a href="/tags/ios/" style="font-size: 11.67px;">ios</a> <a href="/tags/java/" style="font-size: 11.67px;">java</a> <a href="/tags/kotlin/" style="font-size: 10px;">kotlin</a> <a href="/tags/linxu/" style="font-size: 11.67px;">linxu</a> <a href="/tags/mac/" style="font-size: 11.67px;">mac</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/mvp/" style="font-size: 13.33px;">mvp</a> <a href="/tags/offce/" style="font-size: 11.67px;">offce</a> <a href="/tags/resume/" style="font-size: 11.67px;">resume</a> <a href="/tags/rxandroid/" style="font-size: 11.67px;">rxandroid</a> <a href="/tags/rxjava/" style="font-size: 11.67px;">rxjava</a> <a href="/tags/service/" style="font-size: 10px;">service</a> <a href="/tags/springboot/" style="font-size: 10px;">springboot</a> <a href="/tags/view/" style="font-size: 11.67px;">view</a> <a href="/tags/vuforia/" style="font-size: 10px;">vuforia</a> <a href="/tags/web/" style="font-size: 13.33px;">web</a> <a href="/tags/延迟/" style="font-size: 10px;">延迟</a> <a href="/tags/性能优化/" style="font-size: 10px;">性能优化</a> <a href="/tags/文字/" style="font-size: 11.67px;">文字</a> <a href="/tags/歌曲/" style="font-size: 11.67px;">歌曲</a> <a href="/tags/直播/" style="font-size: 10px;">直播</a> <a href="/tags/笔录/" style="font-size: 13.33px;">笔录</a> <a href="/tags/算法/" style="font-size: 10px;">算法</a> <a href="/tags/设计模式/" style="font-size: 13.33px;">设计模式</a> <a href="/tags/软件名词/" style="font-size: 10px;">软件名词</a>
        </div>
    </div>

    
        
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">链接</h3>
        <div class="widget">
            <ul>
                
                    <li>
                        <a href="http://hexo.io">Hexo</a>
                    </li>
                
            </ul>
        </div>
    </div>


    
    <div id="toTop" class="fa fa-angle-up"></div>
</aside>
            
        </div>
        <footer id="footer">
    <div class="outer">
        <div id="footer-info" class="inner">
            &copy; 2022 阿荣<br>
            <!-- <a href="http://github.com/ppoffice">ppoffice</a>     
            主题 - <a href="http://hexo.io/" target="_blank">Hexo</a> -->  
             <a href="#" target="_blank">人生如逆旅  &phi; 我亦是行人 </a>
             <div class="copyright" style="margin-top: 10px;">
 			ICP备案号： <a href="https://beian.miit.gov.cn/" target="_blank">粤ICP备16067940号</a><br>
		</div>	
        </div>
    </div>
</footer>
        
    
    <script type="text/javascript" src="http://v2.uyan.cc/code/uyan.js?uid=2119666"></script>



    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>